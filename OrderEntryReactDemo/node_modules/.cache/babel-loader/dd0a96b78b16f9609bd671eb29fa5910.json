{"ast":null,"code":"var aes = require('./aes');\n\nvar Transform = require('cipher-base');\n\nvar inherits = require('inherits');\n\nvar GHASH = require('./ghash');\n\nvar xor = require('buffer-xor');\n\ninherits(StreamCipher, Transform);\nmodule.exports = StreamCipher;\n\nfunction StreamCipher(mode, key, iv, decrypt) {\n  if (!(this instanceof StreamCipher)) {\n    return new StreamCipher(mode, key, iv);\n  }\n\n  Transform.call(this);\n  this._finID = Buffer.concat([iv, new Buffer([0, 0, 0, 1])]);\n  iv = Buffer.concat([iv, new Buffer([0, 0, 0, 2])]);\n  this._cipher = new aes.AES(key);\n  this._prev = new Buffer(iv.length);\n  this._cache = new Buffer('');\n  this._secCache = new Buffer('');\n  this._decrypt = decrypt;\n  this._alen = 0;\n  this._len = 0;\n  iv.copy(this._prev);\n  this._mode = mode;\n  var h = new Buffer(4);\n  h.fill(0);\n  this._ghash = new GHASH(this._cipher.encryptBlock(h));\n  this._authTag = null;\n  this._called = false;\n}\n\nStreamCipher.prototype._update = function (chunk) {\n  if (!this._called && this._alen) {\n    var rump = 16 - this._alen % 16;\n\n    if (rump < 16) {\n      rump = new Buffer(rump);\n      rump.fill(0);\n\n      this._ghash.update(rump);\n    }\n  }\n\n  this._called = true;\n\n  var out = this._mode.encrypt(this, chunk);\n\n  if (this._decrypt) {\n    this._ghash.update(chunk);\n  } else {\n    this._ghash.update(out);\n  }\n\n  this._len += chunk.length;\n  return out;\n};\n\nStreamCipher.prototype._final = function () {\n  if (this._decrypt && !this._authTag) {\n    throw new Error('Unsupported state or unable to authenticate data');\n  }\n\n  var tag = xor(this._ghash.final(this._alen * 8, this._len * 8), this._cipher.encryptBlock(this._finID));\n\n  if (this._decrypt) {\n    if (xorTest(tag, this._authTag)) {\n      throw new Error('Unsupported state or unable to authenticate data');\n    }\n  } else {\n    this._authTag = tag;\n  }\n\n  this._cipher.scrub();\n};\n\nStreamCipher.prototype.getAuthTag = function getAuthTag() {\n  if (!this._decrypt && Buffer.isBuffer(this._authTag)) {\n    return this._authTag;\n  } else {\n    throw new Error('Attempting to get auth tag in unsupported state');\n  }\n};\n\nStreamCipher.prototype.setAuthTag = function setAuthTag(tag) {\n  if (this._decrypt) {\n    this._authTag = tag;\n  } else {\n    throw new Error('Attempting to set auth tag in unsupported state');\n  }\n};\n\nStreamCipher.prototype.setAAD = function setAAD(buf) {\n  if (!this._called) {\n    this._ghash.update(buf);\n\n    this._alen += buf.length;\n  } else {\n    throw new Error('Attempting to set AAD in unsupported state');\n  }\n};\n\nfunction xorTest(a, b) {\n  var out = 0;\n\n  if (a.length !== b.length) {\n    out++;\n  }\n\n  var len = Math.min(a.length, b.length);\n  var i = -1;\n\n  while (++i < len) {\n    out += a[i] ^ b[i];\n  }\n\n  return out;\n}","map":{"version":3,"sources":["C:/Users/naman.chopra/Git-Repo/eosiodemo/OrderEntryReactDemo/node_modules/eosjs-ecc/node_modules/browserify-aes/authCipher.js"],"names":["aes","require","Transform","inherits","GHASH","xor","StreamCipher","module","exports","mode","key","iv","decrypt","call","_finID","Buffer","concat","_cipher","AES","_prev","length","_cache","_secCache","_decrypt","_alen","_len","copy","_mode","h","fill","_ghash","encryptBlock","_authTag","_called","prototype","_update","chunk","rump","update","out","encrypt","_final","Error","tag","final","xorTest","scrub","getAuthTag","isBuffer","setAuthTag","setAAD","buf","a","b","len","Math","min","i"],"mappings":"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","sourcesContent":["var aes = require('./aes')\nvar Transform = require('cipher-base')\nvar inherits = require('inherits')\nvar GHASH = require('./ghash')\nvar xor = require('buffer-xor')\ninherits(StreamCipher, Transform)\nmodule.exports = StreamCipher\n\nfunction StreamCipher (mode, key, iv, decrypt) {\n  if (!(this instanceof StreamCipher)) {\n    return new StreamCipher(mode, key, iv)\n  }\n  Transform.call(this)\n  this._finID = Buffer.concat([iv, new Buffer([0, 0, 0, 1])])\n  iv = Buffer.concat([iv, new Buffer([0, 0, 0, 2])])\n  this._cipher = new aes.AES(key)\n  this._prev = new Buffer(iv.length)\n  this._cache = new Buffer('')\n  this._secCache = new Buffer('')\n  this._decrypt = decrypt\n  this._alen = 0\n  this._len = 0\n  iv.copy(this._prev)\n  this._mode = mode\n  var h = new Buffer(4)\n  h.fill(0)\n  this._ghash = new GHASH(this._cipher.encryptBlock(h))\n  this._authTag = null\n  this._called = false\n}\nStreamCipher.prototype._update = function (chunk) {\n  if (!this._called && this._alen) {\n    var rump = 16 - (this._alen % 16)\n    if (rump < 16) {\n      rump = new Buffer(rump)\n      rump.fill(0)\n      this._ghash.update(rump)\n    }\n  }\n  this._called = true\n  var out = this._mode.encrypt(this, chunk)\n  if (this._decrypt) {\n    this._ghash.update(chunk)\n  } else {\n    this._ghash.update(out)\n  }\n  this._len += chunk.length\n  return out\n}\nStreamCipher.prototype._final = function () {\n  if (this._decrypt && !this._authTag) {\n    throw new Error('Unsupported state or unable to authenticate data')\n  }\n  var tag = xor(this._ghash.final(this._alen * 8, this._len * 8), this._cipher.encryptBlock(this._finID))\n  if (this._decrypt) {\n    if (xorTest(tag, this._authTag)) {\n      throw new Error('Unsupported state or unable to authenticate data')\n    }\n  } else {\n    this._authTag = tag\n  }\n  this._cipher.scrub()\n}\nStreamCipher.prototype.getAuthTag = function getAuthTag () {\n  if (!this._decrypt && Buffer.isBuffer(this._authTag)) {\n    return this._authTag\n  } else {\n    throw new Error('Attempting to get auth tag in unsupported state')\n  }\n}\nStreamCipher.prototype.setAuthTag = function setAuthTag (tag) {\n  if (this._decrypt) {\n    this._authTag = tag\n  } else {\n    throw new Error('Attempting to set auth tag in unsupported state')\n  }\n}\nStreamCipher.prototype.setAAD = function setAAD (buf) {\n  if (!this._called) {\n    this._ghash.update(buf)\n    this._alen += buf.length\n  } else {\n    throw new Error('Attempting to set AAD in unsupported state')\n  }\n}\nfunction xorTest (a, b) {\n  var out = 0\n  if (a.length !== b.length) {\n    out++\n  }\n  var len = Math.min(a.length, b.length)\n  var i = -1\n  while (++i < len) {\n    out += (a[i] ^ b[i])\n  }\n  return out\n}\n"]},"metadata":{},"sourceType":"script"}