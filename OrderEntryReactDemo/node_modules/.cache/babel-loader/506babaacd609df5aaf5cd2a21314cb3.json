{"ast":null,"code":"\"use strict\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst universal_authenticator_library_1 = require(\"universal-authenticator-library\");\n\nconst anchor_link_1 = __importDefault(require(\"anchor-link\"));\n\nconst eosjs_1 = require(\"eosjs\");\n\nconst interfaces_1 = require(\"./interfaces\");\n\nconst AnchorUser_1 = require(\"./AnchorUser\");\n\nconst AnchorLogo_1 = require(\"./AnchorLogo\");\n\nconst UALAnchorError_1 = require(\"./UALAnchorError\");\n\nconst anchor_link_browser_transport_1 = __importDefault(require(\"anchor-link-browser-transport\"));\n\nclass Anchor extends universal_authenticator_library_1.Authenticator {\n  /**\n   * Anchor Constructor.\n   *\n   * @param chains\n   * @param options { appName } appName is a required option to use Scatter\n   */\n  constructor(chains, options) {\n    super(chains); // Storage for AnchorUser instances\n\n    this.users = []; // the callback service url, defaults to https://cb.anchor.link\n\n    this.service = 'https://cb.anchor.link'; // disable Greymass Fuel cosigning, defaults to false\n\n    this.disableGreymassFuel = false; // display the request status returned by anchor-link, defaults to false (ual has it's own)\n\n    this.requestStatus = false; // Establish initial values\n\n    this.chainId = chains[0].chainId;\n    this.users = []; // Determine the default rpc endpoint for this chain\n\n    const [chain] = chains;\n    const [rpc] = chain.rpcEndpoints; // Ensure the appName is set properly\n\n    if (options && options.appName) {\n      this.appName = options.appName;\n    } else {\n      throw new UALAnchorError_1.UALAnchorError('ual-anchor requires the appName property to be set on the `options` argument during initialization.', universal_authenticator_library_1.UALErrorType.Initialization, null);\n    } // Allow overriding the JsonRpc client via options\n\n\n    if (options && options.rpc) {\n      this.rpc = options.rpc;\n    } else {\n      // otherwise just return a generic rpc instance for this endpoint\n      this.rpc = new eosjs_1.JsonRpc(`${rpc.protocol}://${rpc.host}:${rpc.port}`);\n    } // Allow passing a custom service URL to process callbacks\n\n\n    if (options.service) {\n      this.service = options.service;\n    } // Allow passing of disable flag for Greymass Fuel\n\n\n    if (options && options.disableGreymassFuel) {\n      this.disableGreymassFuel = options.disableGreymassFuel;\n    } // Allow passing of disable flag for resulting request status\n\n\n    if (options && options.requestStatus) {\n      this.requestStatus = options.requestStatus;\n    }\n  }\n  /**\n   * Called after `shouldRender` and should be used to handle any async actions required to initialize the authenticator\n   */\n\n\n  init() {\n    return __awaiter(this, void 0, void 0, function* () {\n      // establish anchor-link\n      this.link = new anchor_link_1.default({\n        chainId: this.chainId,\n        rpc: this.rpc,\n        service: this.service,\n        transport: new anchor_link_browser_transport_1.default({\n          // default: disable browser transport UI status messages, ual has its own\n          requestStatus: this.requestStatus,\n          // default: do not disable fuel by default\n          disableGreymassFuel: this.disableGreymassFuel\n        })\n      }); // attempt to restore any existing session for this app\n\n      const session = yield this.link.restoreSession(this.appName);\n\n      if (session) {\n        this.users = [new AnchorUser_1.AnchorUser(this.rpc, {\n          session\n        })];\n      }\n    });\n  }\n  /**\n   * Resets the authenticator to its initial, default state then calls `init` method\n   */\n\n\n  reset() {\n    this.users = [];\n  }\n  /**\n   * Returns true if the authenticator has errored while initializing.\n   */\n\n\n  isErrored() {\n    return false;\n  }\n  /**\n   * Returns a URL where the user can download and install the underlying authenticator\n   * if it is not found by the UAL Authenticator.\n   */\n\n\n  getOnboardingLink() {\n    return 'https://github.com/greymass/anchor/';\n  }\n  /**\n   * Returns error (if available) if the authenticator has errored while initializing.\n   */\n\n\n  getError() {\n    return null;\n  }\n  /**\n   * Returns true if the authenticator is loading while initializing its internal state.\n   */\n\n\n  isLoading() {\n    return false;\n  }\n\n  getName() {\n    return 'anchor';\n  }\n  /**\n   * Returns the style of the Button that will be rendered.\n   */\n\n\n  getStyle() {\n    return {\n      icon: AnchorLogo_1.AnchorLogo,\n      text: interfaces_1.Name,\n      textColor: 'white',\n      background: '#3650A2'\n    };\n  }\n  /**\n   * Returns whether or not the button should render based on the operating environment and other factors.\n   * ie. If your Authenticator App does not support mobile, it returns false when running in a mobile browser.\n   */\n\n\n  shouldRender() {\n    return !this.isLoading();\n  }\n  /**\n   * Returns whether or not the dapp should attempt to auto login with the Authenticator app.\n   * Auto login will only occur when there is only one Authenticator that returns shouldRender() true and\n   * shouldAutoLogin() true.\n   */\n\n\n  shouldAutoLogin() {\n    return this.users.length > 0;\n  }\n  /**\n   * Returns whether or not the button should show an account name input field.\n   * This is for Authenticators that do not have a concept of account names.\n   */\n\n\n  shouldRequestAccountName() {\n    return __awaiter(this, void 0, void 0, function* () {\n      return false;\n    });\n  }\n  /**\n   * Login using the Authenticator App. This can return one or more users depending on multiple chain support.\n   *\n   * @param accountName  The account name of the user for Authenticators that do not store accounts (optional)\n   */\n\n\n  login() {\n    return __awaiter(this, void 0, void 0, function* () {\n      if (this.chains.length > 1) {\n        throw new UALAnchorError_1.UALAnchorError('UAL-Anchor does not yet support providing multiple chains to UAL. Please initialize the UAL provider with a single chain.', universal_authenticator_library_1.UALErrorType.Unsupported, null);\n      }\n\n      try {\n        // only call the login method if no users exist, to prevent UI from prompting for login during auto login\n        //  some changes to UAL are going to be required to support multiple users\n        if (this.users.length === 0) {\n          const identity = yield this.link.login(this.appName);\n          this.users = [new AnchorUser_1.AnchorUser(this.rpc, identity)];\n        }\n      } catch (e) {\n        throw new UALAnchorError_1.UALAnchorError(e.message, universal_authenticator_library_1.UALErrorType.Login, e);\n      }\n\n      return this.users;\n    });\n  }\n  /**\n   * Logs the user out of the dapp. This will be strongly dependent on each Authenticator app's patterns.\n   */\n\n\n  logout() {\n    return __awaiter(this, void 0, void 0, function* () {\n      // retrieve the current user\n      const [user] = this.users; // retrieve the auth from the current user\n\n      const {\n        session: {\n          auth\n        }\n      } = user; // remove the session from anchor-link\n\n      yield this.link.removeSession(this.appName, auth); // reset the authenticator\n\n      this.reset();\n    });\n  }\n  /**\n   * Returns true if user confirmation is required for `getKeys`\n   */\n\n\n  requiresGetKeyConfirmation() {\n    return false;\n  }\n\n}\n\nexports.Anchor = Anchor;","map":{"version":3,"sources":["C:/Users/naman.chopra/Git-Repo/eosiodemo/OrderEntryReactDemo/node_modules/ual-anchor/dist/Anchor.js"],"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","__importDefault","mod","__esModule","Object","defineProperty","exports","universal_authenticator_library_1","require","anchor_link_1","eosjs_1","interfaces_1","AnchorUser_1","AnchorLogo_1","UALAnchorError_1","anchor_link_browser_transport_1","Anchor","Authenticator","constructor","chains","options","users","service","disableGreymassFuel","requestStatus","chainId","chain","rpc","rpcEndpoints","appName","UALAnchorError","UALErrorType","Initialization","JsonRpc","protocol","host","port","init","link","default","transport","session","restoreSession","AnchorUser","reset","isErrored","getOnboardingLink","getError","isLoading","getName","getStyle","icon","AnchorLogo","text","Name","textColor","background","shouldRender","shouldAutoLogin","length","shouldRequestAccountName","login","Unsupported","identity","message","Login","logout","user","auth","removeSession","requiresGetKeyConfirmation"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst universal_authenticator_library_1 = require(\"universal-authenticator-library\");\nconst anchor_link_1 = __importDefault(require(\"anchor-link\"));\nconst eosjs_1 = require(\"eosjs\");\nconst interfaces_1 = require(\"./interfaces\");\nconst AnchorUser_1 = require(\"./AnchorUser\");\nconst AnchorLogo_1 = require(\"./AnchorLogo\");\nconst UALAnchorError_1 = require(\"./UALAnchorError\");\nconst anchor_link_browser_transport_1 = __importDefault(require(\"anchor-link-browser-transport\"));\nclass Anchor extends universal_authenticator_library_1.Authenticator {\n    /**\n     * Anchor Constructor.\n     *\n     * @param chains\n     * @param options { appName } appName is a required option to use Scatter\n     */\n    constructor(chains, options) {\n        super(chains);\n        // Storage for AnchorUser instances\n        this.users = [];\n        // the callback service url, defaults to https://cb.anchor.link\n        this.service = 'https://cb.anchor.link';\n        // disable Greymass Fuel cosigning, defaults to false\n        this.disableGreymassFuel = false;\n        // display the request status returned by anchor-link, defaults to false (ual has it's own)\n        this.requestStatus = false;\n        // Establish initial values\n        this.chainId = chains[0].chainId;\n        this.users = [];\n        // Determine the default rpc endpoint for this chain\n        const [chain] = chains;\n        const [rpc] = chain.rpcEndpoints;\n        // Ensure the appName is set properly\n        if (options && options.appName) {\n            this.appName = options.appName;\n        }\n        else {\n            throw new UALAnchorError_1.UALAnchorError('ual-anchor requires the appName property to be set on the `options` argument during initialization.', universal_authenticator_library_1.UALErrorType.Initialization, null);\n        }\n        // Allow overriding the JsonRpc client via options\n        if (options && options.rpc) {\n            this.rpc = options.rpc;\n        }\n        else {\n            // otherwise just return a generic rpc instance for this endpoint\n            this.rpc = new eosjs_1.JsonRpc(`${rpc.protocol}://${rpc.host}:${rpc.port}`);\n        }\n        // Allow passing a custom service URL to process callbacks\n        if (options.service) {\n            this.service = options.service;\n        }\n        // Allow passing of disable flag for Greymass Fuel\n        if (options && options.disableGreymassFuel) {\n            this.disableGreymassFuel = options.disableGreymassFuel;\n        }\n        // Allow passing of disable flag for resulting request status\n        if (options && options.requestStatus) {\n            this.requestStatus = options.requestStatus;\n        }\n    }\n    /**\n     * Called after `shouldRender` and should be used to handle any async actions required to initialize the authenticator\n     */\n    init() {\n        return __awaiter(this, void 0, void 0, function* () {\n            // establish anchor-link\n            this.link = new anchor_link_1.default({\n                chainId: this.chainId,\n                rpc: this.rpc,\n                service: this.service,\n                transport: new anchor_link_browser_transport_1.default({\n                    // default: disable browser transport UI status messages, ual has its own\n                    requestStatus: this.requestStatus,\n                    // default: do not disable fuel by default\n                    disableGreymassFuel: this.disableGreymassFuel,\n                }),\n            });\n            // attempt to restore any existing session for this app\n            const session = yield this.link.restoreSession(this.appName);\n            if (session) {\n                this.users = [new AnchorUser_1.AnchorUser(this.rpc, { session })];\n            }\n        });\n    }\n    /**\n     * Resets the authenticator to its initial, default state then calls `init` method\n     */\n    reset() {\n        this.users = [];\n    }\n    /**\n     * Returns true if the authenticator has errored while initializing.\n     */\n    isErrored() {\n        return false;\n    }\n    /**\n     * Returns a URL where the user can download and install the underlying authenticator\n     * if it is not found by the UAL Authenticator.\n     */\n    getOnboardingLink() {\n        return 'https://github.com/greymass/anchor/';\n    }\n    /**\n     * Returns error (if available) if the authenticator has errored while initializing.\n     */\n    getError() {\n        return null;\n    }\n    /**\n     * Returns true if the authenticator is loading while initializing its internal state.\n     */\n    isLoading() {\n        return false;\n    }\n    getName() {\n        return 'anchor';\n    }\n    /**\n     * Returns the style of the Button that will be rendered.\n     */\n    getStyle() {\n        return {\n            icon: AnchorLogo_1.AnchorLogo,\n            text: interfaces_1.Name,\n            textColor: 'white',\n            background: '#3650A2'\n        };\n    }\n    /**\n     * Returns whether or not the button should render based on the operating environment and other factors.\n     * ie. If your Authenticator App does not support mobile, it returns false when running in a mobile browser.\n     */\n    shouldRender() {\n        return !this.isLoading();\n    }\n    /**\n     * Returns whether or not the dapp should attempt to auto login with the Authenticator app.\n     * Auto login will only occur when there is only one Authenticator that returns shouldRender() true and\n     * shouldAutoLogin() true.\n     */\n    shouldAutoLogin() {\n        return this.users.length > 0;\n    }\n    /**\n     * Returns whether or not the button should show an account name input field.\n     * This is for Authenticators that do not have a concept of account names.\n     */\n    shouldRequestAccountName() {\n        return __awaiter(this, void 0, void 0, function* () {\n            return false;\n        });\n    }\n    /**\n     * Login using the Authenticator App. This can return one or more users depending on multiple chain support.\n     *\n     * @param accountName  The account name of the user for Authenticators that do not store accounts (optional)\n     */\n    login() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (this.chains.length > 1) {\n                throw new UALAnchorError_1.UALAnchorError('UAL-Anchor does not yet support providing multiple chains to UAL. Please initialize the UAL provider with a single chain.', universal_authenticator_library_1.UALErrorType.Unsupported, null);\n            }\n            try {\n                // only call the login method if no users exist, to prevent UI from prompting for login during auto login\n                //  some changes to UAL are going to be required to support multiple users\n                if (this.users.length === 0) {\n                    const identity = yield this.link.login(this.appName);\n                    this.users = [new AnchorUser_1.AnchorUser(this.rpc, identity)];\n                }\n            }\n            catch (e) {\n                throw new UALAnchorError_1.UALAnchorError(e.message, universal_authenticator_library_1.UALErrorType.Login, e);\n            }\n            return this.users;\n        });\n    }\n    /**\n     * Logs the user out of the dapp. This will be strongly dependent on each Authenticator app's patterns.\n     */\n    logout() {\n        return __awaiter(this, void 0, void 0, function* () {\n            // retrieve the current user\n            const [user] = this.users;\n            // retrieve the auth from the current user\n            const { session: { auth } } = user;\n            // remove the session from anchor-link\n            yield this.link.removeSession(this.appName, auth);\n            // reset the authenticator\n            this.reset();\n        });\n    }\n    /**\n     * Returns true if user confirmation is required for `getKeys`\n     */\n    requiresGetKeyConfirmation() {\n        return false;\n    }\n}\nexports.Anchor = Anchor;\n"]},"metadata":{},"sourceType":"script"}